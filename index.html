<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <script src="https://aframe.io/releases/1.2.0/aframe.min.js"></script>
    <title>WebRTC Demo</title>
</head>
<body>

<div class="videos">
    <!-- Local Stream Section -->
    <div id="localStream">
        <h3>Local Stream</h3>
        <video id="webcamVideo" autoplay playsinline></video>
    </div>

    <!-- Remote Stream Section -->
    <div id="remoteStream">
        <h3>Remote Stream</h3>
        <video id="remoteVideo" autoplay playsinline></video>
    </div>
</div>

<!-- Control Buttons -->
<h2>1. DESKTOP</h2>
<button id="webcamButton">START</button>

<h2>2. DEVICE</h2>
<button id="answerButton">JOIN</button>

<button id="vrButton">Enter VR!</button>

<!-- A-Frame VR Scene (Hidden Initially) -->
<a-scene id="vrScene" embedded style="display:none">
    <a-assets>
        <video id="remoteVideoStream" autoplay playsinline></video>
    </a-assets>
    <a-videosphere src="#remoteVideoStream"></a-videosphere>
</a-scene>

<script type="module" src="/main.js"></script>

<script>
// VR Button Click Event Listener
var vrButton = document.getElementById('vrButton');
var sceneEl = document.getElementById('vrScene');
var remoteVideo = document.getElementById('remoteVideo');

vrButton.addEventListener('click', function() {
    // Hide the button and get the video stream from the existing remote video element
    vrButton.style.display = 'none';
    var stream = remoteVideo.srcObject;
    var remoteVideoStream = document.getElementById('remoteVideoStream');
    
    // Set the srcObject of the A-Frame video element to the stream
    remoteVideoStream.srcObject = stream;
    
    // Show the A-Frame scene when the remote stream is playing
    remoteVideoStream.onloadedmetadata = function() {
        remoteVideoStream.play();
        sceneEl.style.display = 'block';
        document.querySelector('a-videosphere').setAttribute('src', '#remoteVideoStream');
    };
});

// Additional code for setting up the stream goes here
</script>

</body>
</html>
